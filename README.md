# XeventReader

Xevent Reader is a tool written in Python that reads Extend Event Files of SQL Server and exports parsed results into SQL Server. It is designed to be an alternative to SSMS when the exporting table function crashes. The Reader has two main functions: read and parse xevent files into SQL Server tables and import csv files into SQL Server.

![image-20220817095032595](https://github.com/jason5306/XeventReader/blob/main/img/image-20220817095032595.png)

![image-20220817150923654](https://github.com/jason5306/XeventReader/blob/main/img/image-20220817150923654.png)

## Install

1. Install [Microsoft ODBC Driver17 for SQL Server x64](https://go.microsoft.com/fwlink/?linkid=2200731)
2. Download the tool. [Link]()
3. Protection programs (Windows Security) might be triggered, please allow access.
4. Ready to go.

## Usage

1. Open the tool, please wait for the GUI pops up.

2. **Full execution** mode

   1. Function: read and parse xevent files into SQL Server
   2. Press the **Select Files** button
      1. Select `xevent files (*.xel)` in the drop-down list.
      2. Multiple xevent files can be added.
      3. Different types of xevent files can be added, results will be written into one table.
   3. Choose authentication mode for SQL Server
      1. Default: Windows Authentication 
   4. Fill in the connection info.
      1. HOSTNAME: the server you want to connect to.
      2. DATABASE: the database that holds the result table. If the database does not exist, the Reader would create a new one.
      3. TABLE NAME: the table that holds parsing results. **If the table name exists, the original content of that table will be replaced.**
      4. USERNAME: the user name for SQL Authentication.
      5. PASSWORD: password of SQL Authentication account.
   5. Press **Run: full execution**
      1. If any field is missed, there will be warning messages.
      2. Execution progress is visualized in the command line window.
      3. A temporary  `.csv` file will be generated for debugging purposes, you can choose to delete or keep it when the execution is finished.

3. **Importing CSV to SQL Server Only** mode

   1. Function: import a formatted csv file into a specified SQL Server

      > This mode is designed to import temp csv files to SQL Server generated by the full execution mode when the parsing is completed but importing results to SQL Server is failed.

   2. Press the **Select Files** button

      1. Select `csv files (*.csv)` in the drop down list.
      2. Only one CSV file can be added.

   3. Choose authentication mode for SQL Server

      1. Default: Windows Authentication 

   4. Fill in the connection info.

      1. HOSTNAME: the server you want to connect to.
      2. DATABASE: the database that holds the result table. If the database does not exist, the Reader would create a new one.
      3. TABLE NAME: the table that holds parsing results. **If the table name exists, the original content of that table will be replaced.**
      4. USERNAME: the user name for SQL Authentication.
      5. PASSWORD: password of SQL Authentication account.

   5. Press **Run: import csvCSV to SQL only**

      1. If any field is missed, there will be warning messages.
      2. Execution progress is visualized in the command line window.
      3. You can choose to delete or keep the selected CSV file when the execution is finished.

## Known Issue

1. The GUI gets stuck from time to time when the file selection window is closed.

   > Sol: Press 'Enter' in the command line window would work

2. The GUI window is not popped up when the tool is started for a while.

   > Sol: Press 'Enter' in the command line window would work

2. When dealing with large (total size) xevent files, the importing to SQL Server step might be very slow. The normal importing rate should be several hundred items per second. This might due to the `fast_executemany` for SQL Server is not triggered.

   > Sol: 
   >
   > Firstly, read and parse xevent files with **Run: full execution** to get a temporary csv file. Terminate the tool when the message `Action: Importing to SQL Server table ...` is shown.
   >
   > Secondly, reopen the tool, select the temporary CSV file, fill in necessary connection info, and press **Importing CSV to SQL Server Only** (follow steps of **Importing csCSVo SQL Server Only** mode)
